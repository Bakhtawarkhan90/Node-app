stages:
   - build
   - test
   - push
   - deploy

build_job:
 stage: build
 script:
   - docker build . -t node-app:latest
 tags:
   - dev

test_job:   
  stage: test
  script:
    - echo "TESTING"
  tags:
    - dev

push_job:
 stage: push
 script:
   - docker login -u $DOKCERHUB_USER -p $DOCKERHUB_PASS
   - docker tag node-app:latest $DOKCERHUB_USER/node-app:latest
   - docker push
 tags:
   - dev

deploy_job:
 stage: deploy
 script:
   - docker compose down
   - docker compose up -d
 tags: 
   - dev
